<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "917dbf890db71a322f306050cb284749",
  "translation_date": "2025-10-11T11:58:44+00:00",
  "source_file": "7-TimeSeries/2-ARIMA/README.md",
  "language_code": "ta"
}
-->
# ARIMA роорпВро▓роорпН роирпЗро░рпНроорпБроХроорпН роХрогро┐рокрпНрокрпБ

роорпБроирпНродрпИроп рокро╛роЯродрпНродро┐ро▓рпН, роирпЗро░рпНроорпБроХроорпН роХрогро┐рокрпНрокрпБ рокро▒рпНро▒ро┐роп роЪро┐ро▓ роЕроЯро┐рокрпНрокроЯрпИроХро│рпИ роирпАроЩрпНроХро│рпН роХро▒рпНро▒рпБроХрпНроХрпКрогрпНроЯрпАро░рпНроХро│рпН рооро▒рпНро▒рпБроорпН роТро░рпБ роХрпБро▒ро┐рокрпНрокро┐роЯрпНроЯ роХро╛ро▓родрпНродро┐ро▓рпН рооро┐ройрпНроЪро╛ро░ роЪрпБроорпИ рооро╛ро▒рпБрокро╛роЯрпБроХро│рпИ роХро╛роЯрпНроЯрпБроорпН родро░ро╡рпБродрпНродрпКроХрпБрокрпНрокрпИ роПро▒рпНро▒рпАро░рпНроХро│рпН.

[![ARIMA роЕро▒ро┐роорпБроХроорпН](https://img.youtube.com/vi/IUSk-YDau10/0.jpg)](https://youtu.be/IUSk-YDau10 "ARIMA роЕро▒ро┐роорпБроХроорпН")

> ЁЯОе роорпЗро▓рпЗ роЙро│рпНро│ рокроЯродрпНродрпИ роХро┐ро│ро┐роХрпН роЪрпЖропрпНропро╡рпБроорпН: ARIMA рооро╛родро┐ро░ро┐роХро│рпН рокро▒рпНро▒ро┐роп роЪрпБро░рпБроХрпНроХрооро╛рой роЕро▒ро┐роорпБроХроорпН. роЙродро╛ро░рогроорпН R-ро▓рпН роЪрпЖропрпНропрокрпНрокроЯрпНроЯрпБро│рпНро│родрпБ, роЖройро╛ро▓рпН роХро░рпБродрпНродрпБроХрпНроХро│рпН рокрпКродрпБро╡ро╛ройро╡рпИ.

## [рокро╛роЯродрпНродро┐ро▒рпНроХрпБ роорпБройрпН ро╡ро┐ройро╛роЯро┐ ро╡ро┐ройро╛](https://ff-quizzes.netlify.app/en/ml/)

## роЕро▒ро┐роорпБроХроорпН

роЗроирпНрод рокро╛роЯродрпНродро┐ро▓рпН, [ARIMA: *A*uto*R*egressive *I*ntegrated *M*oving *A*verage](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average) роорпВро▓роорпН рооро╛родро┐ро░ро┐роХро│рпИ роЙро░рпБро╡ро╛роХрпНроХ роТро░рпБ роХрпБро▒ро┐рокрпНрокро┐роЯрпНроЯ роорпБро▒рпИропрпИ роирпАроЩрпНроХро│рпН роХро▒рпНро▒рпБроХрпНроХрпКро│рпНро╡рпАро░рпНроХро│рпН. ARIMA рооро╛родро┐ро░ро┐роХро│рпН роХрпБро▒ро┐рокрпНрокро╛роХ [non-stationarity](https://wikipedia.org/wiki/Stationary_process) роХро╛роЯрпНроЯрпБроорпН родро░ро╡рпБроХро│рпБроХрпНроХрпБ рокрпКро░рпБродрпНродрооро╛роХ роЗро░рпБроХрпНроХрпБроорпН.

## рокрпКродрпБро╡ро╛рой роХро░рпБродрпНродрпБроХрпНроХро│рпН

ARIMA-ропрпБроЯройрпН ро╡рпЗро▓рпИ роЪрпЖропрпНроп, роЪро┐ро▓ роорпБроХрпНроХро┐роп роХро░рпБродрпНродрпБроХро│рпИ роирпАроЩрпНроХро│рпН роЕро▒ро┐роирпНродро┐ро░рпБроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН:

- ЁЯОУ **Stationarity**. рокрпБро│рпНро│ро┐ропро┐ропро▓рпН рокро╛ро░рпНро╡рпИропро┐ро▓рпН, stationarity роОройрпНрокродрпБ роирпЗро░родрпНродро┐ро▓рпН рооро╛ро▒рпНро▒ро┐ропроорпИроХрпНроХрпБроорпНрокрпЛродрпБ роЕродройрпН ро╡ро┐роиро┐ропрпЛроХроорпН рооро╛ро▒ро╛род родро░ро╡рпБроХро│рпИ роХрпБро▒ро┐роХрпНроХро┐ро▒родрпБ. Non-stationary родро░ро╡рпБроХро│рпН, рокро┐ройрпНройро░рпН, рокро░рпБро╡родрпНродро╛ро▓рпН роПро▒рпНрокроЯрпБроорпН рооро╛ро▒рпБрокро╛роЯрпБроХро│рпИ роХро╛роЯрпНроЯрпБроХро┐ро▒родрпБ, роЕро╡ро▒рпНро▒рпИ рокроХрпБрокрпНрокро╛ропрпНро╡рпБ роЪрпЖропрпНроп рооро╛ро▒рпНро▒роорпН роЪрпЖропрпНроп ро╡рпЗрогрпНроЯрпБроорпН. роЙродро╛ро░рогрооро╛роХ, рокро░рпБро╡родрпНродро╛ро▓рпН роПро▒рпНрокроЯрпБроорпН рооро╛ро▒рпБрокро╛роЯрпБроХро│рпИ 'seasonal-differencing' роорпВро▓роорпН роирпАроХрпНроХро▓ро╛роорпН.

- ЁЯОУ **[Differencing](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average#Differencing)**. Differencing роОройрпНрокродрпБ non-stationary родро░ро╡рпБроХро│рпИ stationarity роЖроХ рооро╛ро▒рпНро▒рпБро╡родро▒рпНроХро╛рой роЪрпЖропро▓рпНроорпБро▒рпИропро╛роХрпБроорпН, роЕродро╛ро╡родрпБ роЕродройрпН non-constant trend-роР роирпАроХрпНроХрпБро╡родрпБ. "Differencing роТро░рпБ роирпЗро░рпНроорпБроХродрпН родрпКроЯро░ро┐ройрпН роиро┐ро▓рпИропрпИ рооро╛ро▒рпНро▒рпБро╡родрпИроХрпН роХрпБро▒рпИроХрпНроХро┐ро▒родрпБ, trend рооро▒рпНро▒рпБроорпН seasonality-роР роирпАроХрпНроХро┐, роЕродройрпН роЪро░ро╛роЪро░ро┐ропрпИ роиро┐ро▓рпИрокрпНрокроЯрпБродрпНродрпБроХро┐ро▒родрпБ." [Shixiong et al-роЗройрпН роЖропрпНро╡рпБ](https://arxiv.org/abs/1904.07632)

## роирпЗро░рпНроорпБроХродрпНродро┐ройрпН роЪрпВро┤ро▓ро┐ро▓рпН ARIMA

роирпЗро░рпНроорпБроХродрпН родро░ро╡рпБроХро│рпИ рооро╛родро┐ро░ро┐ропро╛роХрпНроХ ARIMA роОро╡рпНро╡ро╛ро▒рпБ роЙродро╡рпБроХро┐ро▒родрпБ роОройрпНрокродрпИ роиройрпНроХрпБ рокрпБро░ро┐роирпНродрпБроХрпКро│рпНро│ роЕродройрпН рокроХрпБродро┐роХро│рпИрокрпН рокро╛ро░рпНрокрпНрокрпЛроорпН.

- **AR - AutoRegressive**. Autoregressive рооро╛родро┐ро░ро┐роХро│рпН, рокрпЖропро░ро┐ро▓рпЗропрпЗ роЙро│рпНро│родрпБ рокрпЛро▓, роЙроЩрпНроХро│рпН родро░ро╡ро┐ройрпН роорпБроирпНродрпИроп роородро┐рокрпНрокрпБроХро│рпИ 'рокро┐ройрпН' роирпЛроХрпНроХро┐ рокро╛ро░рпНродрпНродрпБ роЕро╡ро▒рпНро▒рпИрокрпН рокроХрпБрокрпНрокро╛ропрпНро╡рпБ роЪрпЖропрпНроХро┐ройрпНро▒рой. роЗроирпНрод роорпБроирпНродрпИроп роородро┐рокрпНрокрпБроХро│рпН 'lags' роОройрпНро▒рпБ роЕро┤рпИроХрпНроХрокрпНрокроЯрпБроХро┐ройрпНро▒рой. роЙродро╛ро░рогрооро╛роХ, рооро╛родро╛роирпНродро┐ро░ рокрпЖройрпНроЪро┐ро▓рпН ро╡ро┐ро▒рпНрокройрпИ родро░ро╡рпБроХро│рпН. роТро╡рпНро╡рпКро░рпБ рооро╛родродрпНродро┐ройрпН ро╡ро┐ро▒рпНрокройрпИ роорпКродрпНродроорпН 'evolving variable' роЖроХроХрпН роХро░рпБродрокрпНрокроЯрпБроорпН. роЗроирпНрод рооро╛родро┐ро░ро┐ "evolving variable of interest is regressed on its own lagged (i.e., prior) values." [wikipedia](https://wikipedia.org/wiki/Autoregressive_integrated_moving_average)

- **I - Integrated**. 'ARMA' рооро╛родро┐ро░ро┐роХро│рпБроЯройрпН роТрокрпНрокро┐роЯрпБроорпНрокрпЛродрпБ, ARIMA-ропро┐ро▓рпН роЙро│рпНро│ 'I' роЕродройрпН *[integrated](https://wikipedia.org/wiki/Order_of_integration)* роЕроорпНроЪродрпНродрпИ роХрпБро▒ро┐роХрпНроХро┐ро▒родрпБ. Non-stationarity-роР роирпАроХрпНроХ differencing рокроЯро┐роХро│рпН рокропройрпНрокроЯрпБродрпНродрокрпНрокроЯрпБроорпН рокрпЛродрпБ родро░ро╡рпБроХро│рпН 'integrated' роЖроХро┐ройрпНро▒рой.

- **MA - Moving Average**. [Moving-average](https://wikipedia.org/wiki/Moving-average_model) роЕроорпНроЪроорпН родро▒рпНрокрпЛродрпИроп рооро▒рпНро▒рпБроорпН роорпБроирпНродрпИроп lags роородро┐рокрпНрокрпБроХро│рпИрокрпН рокро╛ро░рпНродрпНродрпБ output variable-роР родрпАро░рпНрооро╛ройро┐роХрпНроХро┐ро▒родрпБ.

роорпБроХрпНроХро┐ропрооро╛роХ: ARIMA роирпЗро░рпНроорпБроХродрпН родро░ро╡ро┐ройрпН роЪро┐ро▒рокрпНрокрпБ ро╡роЯро┐ро╡родрпНродрпБроХрпНроХрпБ рооро┐роХ роЕро░рпБроХро┐ро▓рпН рокрпКро░рпБроирпНродрпБроорпН рооро╛родро┐ро░ро┐ропрпИ роЙро░рпБро╡ро╛роХрпНроХ рокропройрпНрокроЯрпБродрпНродрокрпНрокроЯрпБроХро┐ро▒родрпБ.

## рокропро┐ро▒рпНроЪро┐ - ARIMA рооро╛родро┐ро░ро┐ропрпИ роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН

роЗроирпНрод рокро╛роЯродрпНродро┐ро▓рпН [_/working_](https://github.com/microsoft/ML-For-Beginners/tree/main/7-TimeSeries/2-ARIMA/working) роХрпЛрокрпНрокрпБро▒рпИропрпИ родро┐ро▒роирпНродрпБ [_notebook.ipynb_](https://github.com/microsoft/ML-For-Beginners/blob/main/7-TimeSeries/2-ARIMA/working/notebook.ipynb) роХрпЛрокрпНрокрпИ роХрогрпНроЯро▒ро┐ропро╡рпБроорпН.

1. `statsmodels` Python роирпВро▓роХродрпНродрпИ роПро▒рпНро▒ро╡рпБроорпН; роЗродрпБ ARIMA рооро╛родро┐ро░ро┐роХро│рпБроХрпНроХрпБ родрпЗро╡рпИрокрпНрокроЯрпБроорпН.

1. родрпЗро╡рпИропро╛рой роирпВро▓роХроЩрпНроХро│рпИ роПро▒рпНро▒ро╡рпБроорпН

1. родро░ро╡рпБроХро│рпИ `/data/energy.csv` роХрпЛрокрпНрокро┐ро▓ро┐ро░рпБроирпНродрпБ Pandas dataframe-роЗро▓рпН роПро▒рпНро▒ро╡рпБроорпН рооро▒рпНро▒рпБроорпН рокро╛ро░рпНро╡рпИропро┐роЯро╡рпБроорпН:

    ```python
    energy = load_data('./data')[['load']]
    energy.head(10)
    ```

1. 2012 роЬройро╡ро░ро┐ роорпБродро▓рпН 2014 роЯро┐роЪроорпНрокро░рпН ро╡ро░рпИ роХро┐роЯрпИроХрпНроХрпБроорпН роЕройрпИродрпНродрпБ рооро┐ройрпНроЪро╛ро░ родро░ро╡рпБроХро│рпИропрпБроорпН ро╡ро░рпИрокроЯрооро╛роХрпНроХро╡рпБроорпН. роЗроирпНрод родро░ро╡рпБроХро│рпИ роорпБроирпНродрпИроп рокро╛роЯродрпНродро┐ро▓рпН рокро╛ро░рпНродрпНродродро╛ро▓рпН роОроирпНрод роЖроЪрпНроЪро░ро┐ропроорпБроорпН роЗро░рпБроХрпНроХро╛родрпБ:

    ```python
    energy.plot(y='load', subplots=True, figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    роЗрокрпНрокрпЛродрпБ, роТро░рпБ рооро╛родро┐ро░ро┐ропрпИ роЙро░рпБро╡ро╛роХрпНроХрпБро╡рпЛроорпН!

### рокропро┐ро▒рпНроЪро┐ рооро▒рпНро▒рпБроорпН роЪрпЛродройрпИ родро░ро╡рпБродрпНродрпКроХрпБрокрпНрокрпБроХро│рпИ роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН

родро░ро╡рпБроХро│рпИ роПро▒рпНро▒ро┐роп рокро┐ро▒роХрпБ, роЕродрпИ рокропро┐ро▒рпНроЪро┐ рооро▒рпНро▒рпБроорпН роЪрпЛродройрпИ родрпКроХрпБрокрпНрокрпБроХро│ро╛роХ рокро┐ро░ро┐роХрпНроХро╡рпБроорпН. рокропро┐ро▒рпНроЪро┐ родрпКроХрпБрокрпНрокро┐ро▓рпН роЙроЩрпНроХро│рпН рооро╛родро┐ро░ро┐ропрпИ рокропро┐ро▒рпНроЪро┐ роЪрпЖропрпНропро╡рпБроорпН. ро╡ро┤роХрпНроХрооро╛роХ, рооро╛родро┐ро░ро┐ рокропро┐ро▒рпНроЪро┐ роорпБроЯро┐роирпНрод рокро┐ро▒роХрпБ, роЕродройрпН родрпБро▓рпНро▓ро┐ропродрпНродрпИ роЪрпЛродройрпИ родрпКроХрпБрокрпНрокрпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ роородро┐рокрпНрокрпАроЯрпБ роЪрпЖропрпНропро╡рпБроорпН. рооро╛родро┐ро░ро┐ роОродро┐ро░рпНроХро╛ро▓ роХро╛ро▓роХроЯрпНроЯроЩрпНроХро│ро┐ро▓рпН роЗро░рпБроирпНродрпБ родроХро╡ро▓рпИрокрпН рокрпЖро▒ро╛рооро▓рпН роЗро░рпБроХрпНроХ, роЪрпЛродройрпИ родрпКроХрпБрокрпНрокрпБ рокропро┐ро▒рпНроЪро┐ родрпКроХрпБрокрпНрокро┐ройрпН рокро┐ройрпНройро░рпН роХро╛ро▓роХроЯрпНроЯродрпНродрпИ роЙро│рпНро│роЯроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН.

1. 2014 роЪрпЖрокрпНроЯроорпНрокро░рпН 1 роорпБродро▓рпН роЕроХрпНроЯрпЛрокро░рпН 31 ро╡ро░рпИ роЗро░рогрпНроЯрпБ рооро╛род роХро╛ро▓родрпНродрпИ рокропро┐ро▒рпНроЪро┐ родрпКроХрпБрокрпНрокрпБроХрпНроХрпБ роТродрпБроХрпНроХро╡рпБроорпН. роЪрпЛродройрпИ родрпКроХрпБрокрпНрокрпБ 2014 роиро╡роорпНрокро░рпН 1 роорпБродро▓рпН роЯро┐роЪроорпНрокро░рпН 31 ро╡ро░рпИ роЗро░рогрпНроЯрпБ рооро╛род роХро╛ро▓родрпНродрпИ роЙро│рпНро│роЯроХрпНроХрпБроорпН:

    ```python
    train_start_dt = '2014-11-01 00:00:00'
    test_start_dt = '2014-12-30 00:00:00'
    ```

    роЗроирпНрод родро░ро╡рпБроХро│рпН родро┐ройроЪро░ро┐ рооро┐ройрпНроЪро╛ро░ рокропройрпНрокро╛роЯрпНроЯрпИ рокро┐ро░родро┐рокро▓ро┐рокрпНрокродро╛ро▓рпН, роТро░рпБ ро╡ро▓рпБро╡ро╛рой рокро░рпБро╡ роорпБро▒рпИ роЙро│рпНро│родрпБ, роЖройро╛ро▓рпН роЪроорпАрокродрпНродро┐роп роиро╛роЯрпНроХро│ро┐ро▓рпН рокропройрпНрокро╛роЯрпНроЯрпБроЯройрпН рооро┐роХро╡рпБроорпН роТродрпНродродро╛роХ роЙро│рпНро│родрпБ.

1. ро╡рпЗро▒рпБрокро╛роЯрпБроХро│рпИ роХро╛роЯрпНроЪро┐рокрпНрокроЯрпБродрпНродро╡рпБроорпН:

    ```python
    energy[(energy.index < test_start_dt) & (energy.index >= train_start_dt)][['load']].rename(columns={'load':'train'}) \
        .join(energy[test_start_dt:][['load']].rename(columns={'load':'test'}), how='outer') \
        .plot(y=['train', 'test'], figsize=(15, 8), fontsize=12)
    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![рокропро┐ро▒рпНроЪро┐ рооро▒рпНро▒рпБроорпН роЪрпЛродройрпИ родро░ро╡рпБроХро│рпН](../../../../translated_images/train-test.8928d14e5b91fc942f0ca9201b2d36c890ea7e98f7619fd94f75de3a4c2bacb9.ta.png)

    роОройро╡рпЗ, родро░ро╡рпБроХро│рпИ рокропро┐ро▒рпНроЪро┐ роЪрпЖропрпНроп роТро░рпБ роЪро┐ро▒ро┐роп роХро╛ро▓ роЪро╛ро│ро░родрпНродрпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡родрпБ рокрпЛродрпБрооро╛ройродро╛роХ роЗро░рпБроХрпНроХрпБроорпН.

    > роХрпБро▒ро┐рокрпНрокрпБ: ARIMA рооро╛родро┐ро░ро┐ропрпИ рокрпКро░рпБродрпНрод рокропройрпНрокроЯрпБродрпНродрпБроорпН роЪрпЖропро▓рпНрокро╛роЯрпБ fitting рокрпЛродрпБ in-sample validation рокропройрпНрокроЯрпБродрпНродрпБро╡родро╛ро▓рпН, validation родро░ро╡рпБроХро│рпИ родро╡ро┐ро░рпНроХрпНроХро▓ро╛роорпН.

### рокропро┐ро▒рпНроЪро┐роХрпНроХро╛рой родро░ро╡рпБроХро│рпИ родропро╛ро░ро┐роХрпНроХро╡рпБроорпН

родро░ро╡рпБроХро│рпИ ро╡роЯро┐роХроЯрпНроЯро┐ рооро▒рпНро▒рпБроорпН роЕро│ро╡рпАроЯрпБ роЪрпЖропрпНро╡родройрпН роорпВро▓роорпН рокропро┐ро▒рпНроЪро┐роХрпНроХро╛рой родро░ро╡рпБроХро│рпИ родропро╛ро░ро┐роХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН. родро░ро╡рпБродрпНродрпКроХрпБрокрпНрокрпИ родрпЗро╡рпИропро╛рой роХро╛ро▓роХроЯрпНроЯроЩрпНроХро│рпН рооро▒рпНро▒рпБроорпН роирпЖроЯрпБро╡ро░ро┐роЪрпИроХро│рпИ роороЯрпНроЯрпБроорпН роЙро│рпНро│роЯроХрпНроХ ро╡роЯро┐роХроЯрпНроЯро╡рпБроорпН, родро░ро╡рпБроХро│рпИ 0,1 роЗроЯрпИро╡рпЖро│ро┐ропро┐ро▓рпН project роЪрпЖропрпНроп роЕро│ро╡рпАроЯрпБ роЪрпЖропрпНропро╡рпБроорпН.

1. роорпБродро▓ро┐ро▓рпН роХрпБро▒ро┐рокрпНрокро┐роЯрокрпНрокроЯрпНроЯ роХро╛ро▓роХроЯрпНроЯроЩрпНроХро│рпН рооро▒рпНро▒рпБроорпН 'load' роирпЖроЯрпБро╡ро░ро┐роЪрпИ роороЯрпНроЯрпБроорпН роЙро│рпНро│роЯроХрпНроХ родро░ро╡рпБродрпНродрпКроХрпБрокрпНрокрпИ ро╡роЯро┐роХроЯрпНроЯро╡рпБроорпН:

    ```python
    train = energy.copy()[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']]
    test = energy.copy()[energy.index >= test_start_dt][['load']]

    print('Training data shape: ', train.shape)
    print('Test data shape: ', test.shape)
    ```

    родро░ро╡ро┐ройрпН ро╡роЯро┐ро╡родрпНродрпИ роирпАроЩрпНроХро│рпН роХро╛рогро▓ро╛роорпН:

    ```output
    Training data shape:  (1416, 1)
    Test data shape:  (48, 1)
    ```

1. родро░ро╡рпБроХро│рпИ (0, 1) ро╡ро░роорпНрокро┐ро▓рпН роЕро│ро╡рпАроЯрпБ роЪрпЖропрпНропро╡рпБроорпН.

    ```python
    scaler = MinMaxScaler()
    train['load'] = scaler.fit_transform(train)
    train.head(10)
    ```

1. роЕроЪро▓рпН родро░ро╡рпБроЯройрпН роТрокрпНрокро┐роЯрпБроорпН роЕро│ро╡рпАроЯрпБ роЪрпЖропрпНропрокрпНрокроЯрпНроЯ родро░ро╡рпБроХро│рпИ роХро╛роЯрпНроЪро┐рокрпНрокроЯрпБродрпНродро╡рпБроорпН:

    ```python
    energy[(energy.index >= train_start_dt) & (energy.index < test_start_dt)][['load']].rename(columns={'load':'original load'}).plot.hist(bins=100, fontsize=12)
    train.rename(columns={'load':'scaled load'}).plot.hist(bins=100, fontsize=12)
    plt.show()
    ```

    ![роЕроЪро▓рпН](../../../../translated_images/original.b2b15efe0ce92b8745918f071dceec2231661bf49c8db6918e3ff4b3b0b183c2.ta.png)

    > роЕроЪро▓рпН родро░ро╡рпБроХро│рпН

    ![роЕро│ро╡рпАроЯрпБ роЪрпЖропрпНропрокрпНрокроЯрпНроЯ](../../../../translated_images/scaled.e35258ca5cd3d43f86d5175e584ba96b38d51501f234abf52e11f4fe2631e45f.ta.png)

    > роЕро│ро╡рпАроЯрпБ роЪрпЖропрпНропрокрпНрокроЯрпНроЯ родро░ро╡рпБроХро│рпН

1. роЗрокрпНрокрпЛродрпБ роЕро│ро╡рпАроЯрпБ роЪрпЖропрпНропрокрпНрокроЯрпНроЯ родро░ро╡рпБроХро│рпИ роЪро░ро┐роЪрпЖропрпНрод рокро┐ро▒роХрпБ, роЪрпЛродройрпИ родро░ро╡рпБроХро│рпИ роЕро│ро╡рпАроЯрпБ роЪрпЖропрпНропро╡рпБроорпН:

    ```python
    test['load'] = scaler.transform(test)
    test.head()
    ```

### ARIMA-роР роЪрпЖропро▓рпНрокроЯрпБродрпНродро╡рпБроорпН

роЗрокрпНрокрпЛродрпБ ARIMA-роР роЪрпЖропро▓рпНрокроЯрпБродрпНрод роирпЗро░роорпН! роирпАроЩрпНроХро│рпН роорпБройрпНрокрпБ роиро┐ро▒рпБро╡ро┐роп `statsmodels` роирпВро▓роХродрпНродрпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡рпАро░рпНроХро│рпН.

роЗрокрпНрокрпЛродрпБ роЪро┐ро▓ рокроЯро┐роХро│рпИ рокро┐ройрпНрокро▒рпНро▒ ро╡рпЗрогрпНроЯрпБроорпН:

   1. `SARIMAX()`-роР роЕро┤рпИродрпНродрпБ рооро╛родро┐ро░ро┐ропро┐ройрпН роЕро│ро╡рпБро░рпБроХрпНроХро│рпИ: p, d, рооро▒рпНро▒рпБроорпН q роЕро│ро╡рпБро░рпБроХрпНроХро│рпН, рооро▒рпНро▒рпБроорпН P, D, рооро▒рпНро▒рпБроорпН Q роЕро│ро╡рпБро░рпБроХрпНроХро│рпН ро╡ро┤роЩрпНроХро┐ рооро╛родро┐ро░ро┐ропрпИ ро╡ро░рпИропро▒рпБроХрпНроХро╡рпБроорпН.
   2. `fit()` роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИ роЕро┤рпИродрпНродрпБ рокропро┐ро▒рпНроЪро┐ родро░ро╡рпБроХрпНроХро╛рой рооро╛родро┐ро░ро┐ропрпИ родропро╛ро░ро┐роХрпНроХро╡рпБроорпН.
   3. `forecast()` роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИ роЕро┤рпИродрпНродрпБ роорпБройрпНройро▒ро┐ро╡ро┐рокрпНрокрпБ роЪрпЖропрпНропро╡рпБроорпН рооро▒рпНро▒рпБроорпН роорпБройрпНройро▒ро┐ро╡ро┐рокрпНрокрпБ роЪрпЖропрпНроп ро╡рпЗрогрпНроЯро┐роп рокроЯро┐роХро│рпН (the `horizon`) роХрпБро▒ро┐рокрпНрокро┐роЯро╡рпБроорпН.

> ЁЯОУ роЗроирпНрод роЕро│ро╡рпБро░рпБроХрпНроХро│рпН роОродро▒рпНроХро╛роХ? ARIMA рооро╛родро┐ро░ро┐ропро┐ро▓рпН, роирпЗро░рпНроорпБроХродрпНродро┐ройрпН роорпБроХрпНроХро┐роп роЕроорпНроЪроЩрпНроХро│рпИ: рокро░рпБро╡роорпН, рокрпЛроХрпНроХрпБ, рооро▒рпНро▒рпБроорпН роЪродрпНродроорпН рооро╛родро┐ро░ро┐ропро╛роХрпНроХ роЙродро╡рпБроорпН 3 роЕро│ро╡рпБро░рпБроХрпНроХро│рпН роЙро│рпНро│рой:

`p`: рооро╛родро┐ро░ро┐ропро┐ройрпН auto-regressive роЕроорпНроЪродрпНродрпБроЯройрпН родрпКроЯро░рпНрокрпБроЯрпИроп роЕро│ро╡рпБро░рпБ, роЗродрпБ *роорпБроирпНродрпИроп* роородро┐рокрпНрокрпБроХро│рпИ роЙро│рпНро│роЯроХрпНроХрпБроХро┐ро▒родрпБ.
`d`: рооро╛родро┐ро░ро┐ропро┐ройрпН integrated рокроХрпБродро┐роХрпНроХрпБ родрпКроЯро░рпНрокрпБроЯрпИроп роЕро│ро╡рпБро░рпБ, роЗродрпБ роирпЗро░рпНроорпБроХродрпН родрпКроЯро░ро┐ро▓рпН *differencing* (ЁЯОУ differencing-роР роиро┐ройрпИро╡ро┐ро▓рпН роХрпКро│рпНро│рпБроЩрпНроХро│рпН ЁЯСЖ?) роЕро│ро╡рпИ рокро╛родро┐роХрпНроХро┐ро▒родрпБ.
`q`: рооро╛родро┐ро░ро┐ропро┐ройрпН moving-average рокроХрпБродро┐роХрпНроХрпБ родрпКроЯро░рпНрокрпБроЯрпИроп роЕро│ро╡рпБро░рпБ.

> роХрпБро▒ро┐рокрпНрокрпБ: роЙроЩрпНроХро│рпН родро░ро╡рпБроХро│ро┐ро▓рпН рокро░рпБро╡ роЕроорпНроЪроорпН роЗро░рпБроирпНродро╛ро▓рпН - роЗроирпНрод родро░ро╡рпБроХро│ро┐ро▓рпН роЙро│рпНро│родрпБ - , seasonal ARIMA рооро╛родро┐ро░ро┐ (SARIMA) рокропройрпНрокроЯрпБродрпНрод ро╡рпЗрогрпНроЯрпБроорпН. роЕроирпНрод роирпЗро░родрпНродро┐ро▓рпН, `p`, `d`, рооро▒рпНро▒рпБроорпН `q`-роХрпНроХрпБ роТродрпНрод seasonal роХрпВро▒рпБроХро│рпИ ро╡ро┐ро╡ро░ро┐роХрпНроХ `P`, `D`, рооро▒рпНро▒рпБроорпН `Q` роЕро│ро╡рпБро░рпБроХрпНроХро│рпН родрпЗро╡рпИрокрпНрокроЯрпБроорпН.

1. роЙроЩрпНроХро│рпН ро╡ро┐ро░рпБрокрпНрокрооро╛рой horizon роородро┐рокрпНрокрпИ роЕроорпИроХрпНроХ родрпКроЯроЩрпНроХрпБроЩрпНроХро│рпН. 3 роорогро┐ роирпЗро░роорпН роорпБропро▒рпНроЪро┐роХрпНроХро▓ро╛роорпН:

    ```python
    # Specify the number of steps to forecast ahead
    HORIZON = 3
    print('Forecasting horizon:', HORIZON, 'hours')
    ```

    ARIMA рооро╛родро┐ро░ро┐ропро┐ройрпН роЕро│ро╡рпБро░рпБроХрпНроХро│рпБроХрпНроХрпБ роЪро┐ро▒роирпНрод роородро┐рокрпНрокрпБроХро│рпИ родрпЗро░рпНроирпНродрпЖроЯрпБрокрпНрокродрпБ роЪро▒рпНро▒рпБ роЪро┐роХрпНроХро▓ро╛ройродрпБ рооро▒рпНро▒рпБроорпН роирпЗро░роорпН рокро┐роЯро┐роХрпНроХрпБроорпН. [`pyramid` роирпВро▓роХродрпНродро┐ройрпН](https://alkaline-ml.com/pmdarima/0.9.0/modules/generated/pyramid.arima.auto_arima.html) `auto_arima()` роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИрокрпН рокропройрпНрокроЯрпБродрпНрод рокро░ро┐роирпНродрпБро░рпИроХрпНроХро▓ро╛роорпН.

1. родро▒рпНрокрпЛродрпБ роЪро┐ро▓ роХрпИропрпЗроЯрпБ родрпЗро░рпНро╡рпБроХро│рпИ роорпБропро▒рпНроЪро┐родрпНродрпБ роТро░рпБ роиро▓рпНро▓ рооро╛родро┐ро░ро┐ропрпИ роХрогрпНроЯро▒ро┐ропро╡рпБроорпН.

    ```python
    order = (4, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    model = SARIMAX(endog=train, order=order, seasonal_order=seasonal_order)
    results = model.fit()

    print(results.summary())
    ```

    роорпБроЯро┐ро╡рпБроХро│ро┐ройрпН роТро░рпБ роЕроЯрпНроЯро╡рогрпИ роЕроЪрпНроЪро┐роЯрокрпНрокроЯрпБроХро┐ро▒родрпБ.

роирпАроЩрпНроХро│рпН роЙроЩрпНроХро│рпН роорпБродро▓рпН рооро╛родро┐ро░ро┐ропрпИ роЙро░рпБро╡ро╛роХрпНроХро┐ропрпБро│рпНро│рпАро░рпНроХро│рпН! роЗрокрпНрокрпЛродрпБ роЕродрпИ роородро┐рокрпНрокрпАроЯрпБ роЪрпЖропрпНроп роТро░рпБ ро╡ро┤ро┐ропрпИ роХрогрпНроЯро▒ро┐роп ро╡рпЗрогрпНроЯрпБроорпН.

### роЙроЩрпНроХро│рпН рооро╛родро┐ро░ро┐ропрпИ роородро┐рокрпНрокрпАроЯрпБ роЪрпЖропрпНропро╡рпБроорпН

роЙроЩрпНроХро│рпН рооро╛родро┐ро░ро┐ропрпИ роородро┐рокрпНрокрпАроЯрпБ роЪрпЖропрпНроп, `walk forward` validation роОройрокрпНрокроЯрпБроорпН роорпБро▒рпИропрпИ роЪрпЖропро▓рпНрокроЯрпБродрпНродро▓ро╛роорпН. роироЯрпИроорпБро▒рпИропро┐ро▓рпН, роирпЗро░рпНроорпБроХ рооро╛родро┐ро░ро┐роХро│рпН рокрпБродро┐роп родро░ро╡рпБроХро│рпН роХро┐роЯрпИроХрпНроХрпБроорпН роТро╡рпНро╡рпКро░рпБ роорпБро▒рпИропрпБроорпН роорпАрогрпНроЯрпБроорпН рокропро┐ро▒рпНроЪро┐ роЪрпЖропрпНропрокрпНрокроЯрпБроХро┐ройрпНро▒рой. роЗродрпБ роТро╡рпНро╡рпКро░рпБ роирпЗро░роХрпНроХроЯрпНроЯродрпНродро┐ро▓рпБроорпН роЪро┐ро▒роирпНрод роорпБройрпНройро▒ро┐ро╡ро┐рокрпНрокрпИ роЪрпЖропрпНроп рооро╛родро┐ро░ро┐ропрпИ роЕройрпБроородро┐роХрпНроХро┐ро▒родрпБ.

роЗроирпНрод родрпКро┤ро┐ро▓рпНроирпБроЯрпНрокродрпНродрпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ роирпЗро░рпНроорпБроХродрпН родрпКроЯро░ро┐ройрпН родрпКроЯроХрпНроХродрпНродро┐ро▓рпН роЗро░рпБроирпНродрпБ, рокропро┐ро▒рпНроЪро┐ родро░ро╡рпБродрпНродрпКроХрпБрокрпНрокро┐ро▓рпН рооро╛родро┐ро░ро┐ропрпИ рокропро┐ро▒рпНроЪро┐ роЪрпЖропрпНропро╡рпБроорпН. рокро┐ройрпНройро░рпН, роЕроЯрпБродрпНрод роирпЗро░роХрпНроХроЯрпНроЯродрпНродро┐ро▓рпН роТро░рпБ роорпБройрпНройро▒ро┐ро╡ро┐рокрпНрокрпБ роЪрпЖропрпНропро╡рпБроорпН. роорпБройрпНройро▒ро┐ро╡ро┐рокрпНрокрпБ роЕро▒ро┐ропрокрпНрокроЯрпНроЯ роородро┐рокрпНрокрпБроЯройрпН роородро┐рокрпНрокрпАроЯрпБ роЪрпЖропрпНропрокрпНрокроЯрпБроХро┐ро▒родрпБ. рокро┐ройрпНройро░рпН рокропро┐ро▒рпНроЪро┐ родрпКроХрпБрокрпНрокрпБ роЕро▒ро┐ропрокрпНрокроЯрпНроЯ роородро┐рокрпНрокрпИ роЙро│рпНро│роЯроХрпНроХ ро╡ро┐ро░ро┐ро╡ро╛роХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ, рооро▒рпНро▒рпБроорпН роЪрпЖропро▓рпНроорпБро▒рпИ роорпАрогрпНроЯрпБроорпН роЪрпЖропрпНропрокрпНрокроЯрпБроХро┐ро▒родрпБ.

> роХрпБро▒ро┐рокрпНрокрпБ: рокропро┐ро▒рпНроЪро┐ родрпКроХрпБрокрпНрокрпБ роЪро╛ро│ро░родрпНродрпИ роиро┐ро▓рпИропро╛роХ ро╡рпИродрпНродро┐ро░рпБрокрпНрокродрпБ рокропро┐ро▒рпНроЪро┐ропрпИ роорпЗро▓рпБроорпН родро┐ро▒роорпИропро╛роХ роЪрпЖропрпНроп роЙродро╡рпБроорпН, роТро╡рпНро╡рпКро░рпБ роорпБро▒рпИропрпБроорпН роирпАроЩрпНроХро│рпН рокропро┐ро▒рпНроЪро┐ родрпКроХрпБрокрпНрокро┐ро▓рпН рокрпБродро┐роп роХрогрпНроХро╛рогро┐рокрпНрокрпИроЪрпН роЪрпЗро░рпНроХрпНроХрпБроорпН рокрпЛродрпБ, родрпКроХрпБрокрпНрокро┐ройрпН родрпКроЯроХрпНроХродрпНродро┐ро▓рпН роЗро░рпБроирпНродрпБ роХрогрпНроХро╛рогро┐рокрпНрокрпИ роирпАроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН.

роЗроирпНрод роЪрпЖропро▓рпНроорпБро▒рпИ рооро╛родро┐ро░ро┐ роироЯрпИроорпБро▒рпИропро┐ро▓рпН роОрокрпНрокроЯро┐ роЪрпЖропро▓рпНрокроЯрпБроорпН роОройрпНрокродрпИ роорпЗро▓рпБроорпН ро╡ро▓рпБро╡ро╛рой роородро┐рокрпНрокрпАроЯрпНроЯрпИ ро╡ро┤роЩрпНроХрпБроХро┐ро▒родрпБ. роЗро░рпБрокрпНрокро┐ройрпБроорпН, роЗродрпБ рокро▓ рооро╛родро┐ро░ро┐роХро│рпИ роЙро░рпБро╡ро╛роХрпНроХрпБро╡родро▒рпНроХро╛рой роХрогро┐ройро┐ роЪрпЖро▓ро╡рпБроЯройрпН ро╡ро░рпБроХро┐ро▒родрпБ. родро░ро╡рпБроХро│рпН роЪро┐ро▒ро┐ропродро╛роХ роЗро░рпБроирпНродро╛ро▓рпН роЕро▓рпНро▓родрпБ рооро╛родро┐ро░ро┐ роОро│ро┐роорпИропро╛ройродро╛роХ роЗро░рпБроирпНродро╛ро▓рпН роЗродрпБ роПро▒рпНро▒рпБроХрпНроХрпКро│рпНро│роХрпНроХрпВроЯро┐ропродрпБ, роЖройро╛ро▓рпН роЕро│ро╡ро┐ро▓ро╛рой родро░ро╡рпБроХро│рпБроХрпНроХрпБ роЗродрпБ роЪро┐роХрпНроХро▓ро╛роХ роЗро░рпБроХрпНроХро▓ро╛роорпН.

Walk-forward validation роирпЗро░рпНроорпБроХ рооро╛родро┐ро░ро┐ роородро┐рокрпНрокрпАроЯрпНроЯро┐ройрпН родроЩрпНроХ роиро┐ро▓рпИроорпИропро╛роХрпБроорпН рооро▒рпНро▒рпБроорпН роЙроЩрпНроХро│рпН роЪрпКроирпНрод родро┐роЯрпНроЯроЩрпНроХро│рпБроХрпНроХрпБ рокро░ро┐роирпНродрпБро░рпИроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ.

1. роТро╡рпНро╡рпКро░рпБ HORIZON рокроЯро┐роХрпНроХроЯрпНроЯро┐ро▒рпНроХро╛рой роЪрпЛродройрпИ родро░ро╡рпБрокрпН рокрпБро│рпНро│ро┐ропрпИ роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН.

    ```python
    test_shifted = test.copy()

    for t in range(1, HORIZON+1):
        test_shifted['load+'+str(t)] = test_shifted['load'].shift(-t, freq='H')

    test_shifted = test_shifted.dropna(how='any')
    test_shifted.head(5)
    ```

    |            |          | load | load+1 | load+2 |
    | ---------- | -------- | ---- | ------ | ------ |
    | 2014-12-30 | 00:00:00 | 0.33 | 0.29   | 0.27   |
    | 2014-12-30 | 01:00:00 | 0.29 | 0.27   | 0.27   |
    | 2014-12-30 | 02:00:00 | 0.27 | 0.27   | 0.30   |
    | 2014-12-30 | 03:00:00 | 0.27 | 0.30   | 0.41   |
    | 2014-12-30 | 04:00:00 | 0.30 | 0.41   | 0.57   |

    родро░ро╡рпБроХро│рпН роЕродройрпН horizon рокрпБро│рпНро│ро┐роХрпНроХрпБ роПро▒рпНрок роХро┐роЯрпИроороЯрпНроЯрооро╛роХ рооро╛ро▒рпНро▒рокрпНрокроЯрпБроХро┐ройрпНро▒рой.

1. роЪрпЛродройрпИ родро░ро╡рпБроХро│ро┐ро▓рпН роорпБройрпНройро▒ро┐ро╡ро┐рокрпНрокрпБроХро│рпИ роЗроирпНрод sliding window роЕрогрпБроХрпБроорпБро▒рпИропрпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ роЪрпЛродройрпИ родро░ро╡ро┐ройрпН роирпАро│родрпНродро┐ро▒рпНроХрпБ роЪроорооро╛рой роТро░рпБ роороЯроХрпНроХродрпНродро┐ро▓рпН роЪрпЖропрпНропро╡рпБроорпН:

    ```python
    %%time
    training_window = 720 # dedicate 30 days (720 hours) for training

    train_ts = train['load']
    test_ts = test_shifted

    history = [x for x in train_ts]
    history = history[(-training_window):]

    predictions = list()

    order = (2, 1, 0)
    seasonal_order = (1, 1, 0, 24)

    for t in range(test_ts.shape[0]):
        model = SARIMAX(endog=history, order=order, seasonal_order=seasonal_order)
        model_fit = model.fit()
        yhat = model_fit.forecast(steps = HORIZON)
        predictions.append(yhat)
        obs = list(test_ts.iloc[t])
        # move the training window
        history.append(obs[0])
        history.pop(0)
        print(test_ts.index[t])
        print(t+1, ': predicted =', yhat, 'expected =', obs)
    ```

    рокропро┐ро▒рпНроЪро┐ роироЯрпИрокрпЖро▒рпБро╡родрпИ роирпАроЩрпНроХро│рпН роХро╛рогро▓ро╛роорпН:

    ```output
    2014-12-30 00:00:00
    1 : predicted = [0.32 0.29 0.28] expected = [0.32945389435989236, 0.2900626678603402, 0.2739480752014323]

    2014-12-30 01:00:00
    2 : predicted = [0.3  0.29 0.3 ] expected = [0.2900626678603402, 0.2739480752014323, 0.26812891674127126]

    2014-12-30 02:00:00
    3 : predicted = [0.27 0.28 0.32] expected = [0.2739480752014323, 0.26812891674127126, 0.3025962399283795]
    ```

1. роорпБройрпНройро▒ро┐ро╡ро┐рокрпНрокрпБроХро│рпИ роЙрогрпНроорпИропро╛рой load-роР роТрокрпНрокро┐роЯро╡рпБроорпН:

    ```python
    eval_df = pd.DataFrame(predictions, columns=['t+'+str(t) for t in range(1, HORIZON+1)])
    eval_df['timestamp'] = test.index[0:len(test.index)-HORIZON+1]
    eval_df = pd.melt(eval_df, id_vars='timestamp', value_name='prediction', var_name='h')
    eval_df['actual'] = np.array(np.transpose(test_ts)).ravel()
    eval_df[['prediction', 'actual']] = scaler.inverse_transform(eval_df[['prediction', 'actual']])
    eval_df.head()
    ```

    ро╡рпЖро│ро┐ропрпАроЯрпБ
    |     |            | timestamp | h   | prediction | actual   |
    | --- | ---------- | --------- | --- | ---------- | -------- |
    | 0   | 2014-12-30 | 00:00:00  | t+1 | 3,008.74   | 3,023.00 |
    | 1   | 2014-12-30 | 01:00:00  | t+1 | 2,955.53   | 2,935.00 |
    | 2   | 2014-12-30 | 02:00:00  | t+1 | 2,900.17   | 2,899.00 |
    | 3   | 2014-12-30 | 03:00:00  | t+1 | 2,917.69   | 2,886.00 |
    | 4   | 2014-12-30 | 04:00:00  | t+1 | 2,946.99   | 2,963.00 |

    роорогро┐роирпЗро░ родро░ро╡ро┐ройрпН роорпБройрпНройро▒ро┐ро╡ро┐рокрпНрокрпИ, роЙрогрпНроорпИропро╛рой load-роР роТрокрпНрокро┐роЯро╡рпБроорпН. роЗродрпБ роОро╡рпНро╡ро│ро╡рпБ родрпБро▓рпНро▓ро┐ропрооро╛роХ роЙро│рпНро│родрпБ?

### рооро╛родро┐ро░ро┐ родрпБро▓рпНро▓ро┐ропродрпНродрпИроЪрпН роЪро░ро┐рокро╛ро░рпНроХрпНроХро╡рпБроорпН

роорпБройрпНройро▒ро┐ро╡ро┐рокрпНрокрпБроХро│ро┐ройрпН mean absolute percentage error (MAPE)-роР роЪрпЛродройрпИ роЪрпЖропрпНродрпБ роЙроЩрпНроХро│рпН рооро╛родро┐ро░ро┐ропро┐ройрпН родрпБро▓рпНро▓ро┐ропродрпНродрпИроЪрпН роЪро░ро┐рокро╛ро░рпНроХрпНроХро╡рпБроорпН.

> **ЁЯзо роХрогро┐родродрпНродрпИ роХро╛роЯрпНроЯро╡рпБроорпН**
>
> ![MAPE](../../../../translated_images/mape.fd87bbaf4d346846df6af88b26bf6f0926bf9a5027816d5e23e1200866e3e8a4.ta.png)
>
> [MAPE](https://www.linkedin.com/pulse/what-mape-mad-msd-time-series-allameh-statistics/) роОройрпНрокродрпБ роорпЗро▓рпЗ роХрпКроЯрпБроХрпНроХрокрпНрокроЯрпНроЯ роЪрооройрпНрокро╛роЯрпНроЯро┐ройрпН роорпВро▓роорпН ро╡ро░рпИропро▒рпБроХрпНроХрокрпНрокроЯрпНроЯ ро╡ро┐роХро┐родрооро╛роХ роХрогро┐рокрпНрокрпБ родрпБро▓рпНро▓ро┐ропродрпНродрпИ роХро╛роЯрпНроЯ рокропройрпНрокроЯрпБродрпНродрокрпНрокроЯрпБроХро┐ро▒родрпБ. роЙрогрпНроорпИропро╛рой<sub>t</sub> рооро▒рпНро▒рпБроорпН роХрогро┐роХрпНроХрокрпНрокроЯрпНроЯ<sub>t</sub> роЗроЯрпИропрпЗропро╛рой ро╡рпЗро▒рпБрокро╛роЯрпБ роЙрогрпНроорпИропро╛рой<sub>t</sub> роорпВро▓роорпН ро╡роХрпБроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ. "роЗроирпНрод роХрогроХрпНроХрпАроЯрпНроЯро┐ро▓рпН роЙро│рпНро│ роорпБро┤рпБ роородро┐рокрпНрокрпБ роТро╡рпНро╡рпКро░рпБ роХрогро┐роХрпНроХрокрпНрокроЯрпНроЯ роирпЗро░ рокрпБро│рпНро│ро┐роХрпНроХрпБроорпН роЪрпЗро░рпНроХрпНроХрокрпНрокроЯрпНроЯрпБ, рокрпКро░рпБродрпНродрокрпНрокроЯрпНроЯ рокрпБро│рпНро│ро┐роХро│ро┐ройрпН роОрогрпНрогро┐роХрпНроХрпИропро╛ро▓рпН n ро╡роХрпБроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ." [wikipedia](https://wikipedia.org/wiki/Mean_absolute_percentage_error)

1. роЪрооройрпНрокро╛роЯрпНроЯрпИ роХрпБро▒ро┐ропрпАроЯрпНроЯро┐ро▓рпН ро╡рпЖро│ро┐рокрпНрокроЯрпБродрпНродро╡рпБроорпН:

    ```python
    if(HORIZON > 1):
        eval_df['APE'] = (eval_df['prediction'] - eval_df['actual']).abs() / eval_df['actual']
        print(eval_df.groupby('h')['APE'].mean())
    ```

1. роТро░рпБ рокроЯро┐ропро┐ройрпН MAPE роР роХрогроХрпНроХро┐роЯро╡рпБроорпН:

    ```python
    print('One step forecast MAPE: ', (mape(eval_df[eval_df['h'] == 't+1']['prediction'], eval_df[eval_df['h'] == 't+1']['actual']))*100, '%')
    ```

    роТро░рпБ рокроЯро┐ роХрогро┐рокрпНрокрпБ MAPE:  0.5570581332313952 %

1. рокро▓ рокроЯро┐ роХрогро┐рокрпНрокрпБ MAPE роР роЕроЪрпНроЪро┐роЯро╡рпБроорпН:

    ```python
    print('Multi-step forecast MAPE: ', mape(eval_df['prediction'], eval_df['actual'])*100, '%')
    ```

    ```output
    Multi-step forecast MAPE:  1.1460048657704118 %
    ```

    роТро░рпБ роЪро┐ро▒роирпНрод роХрпБро▒рпИроирпНрод роОрогрпНрогро┐роХрпНроХрпИ роЪро┐ро▒роирпНродродрпБ: MAPE 10 роОройрпНро▒ро╛ро▓рпН, роЕродрпБ 10% родро╡ро▒ро╛роХ роЙро│рпНро│родрпБ роОройрпНро▒рпБ рокрпКро░рпБро│рпН.

1. роЖройро╛ро▓рпН роОрокрпНрокрпЛродрпБроорпН рокрпЛро▓, роЗроирпНрод рооро╛родро┐ро░ро┐ропро╛рой родрпБро▓рпНро▓ро┐роп роЕро│ро╡рпАроЯрпНроЯрпИ роХрогрпНрогрпБроХрпНроХрпБ родрпЖро│ро┐ро╡ро╛роХ рокро╛ро░рпНроХрпНроХ роОро│ро┐родро╛роХ роЗро░рпБроХрпНроХрпБроорпН, роОройро╡рпЗ роЗродрпИ ро╡ро░рпИрокроЯрооро╛роХ ро╡ро░рпИро╡рпЛроорпН:

    ```python
     if(HORIZON == 1):
        ## Plotting single step forecast
        eval_df.plot(x='timestamp', y=['actual', 'prediction'], style=['r', 'b'], figsize=(15, 8))

    else:
        ## Plotting multi step forecast
        plot_df = eval_df[(eval_df.h=='t+1')][['timestamp', 'actual']]
        for t in range(1, HORIZON+1):
            plot_df['t+'+str(t)] = eval_df[(eval_df.h=='t+'+str(t))]['prediction'].values

        fig = plt.figure(figsize=(15, 8))
        ax = plt.plot(plot_df['timestamp'], plot_df['actual'], color='red', linewidth=4.0)
        ax = fig.add_subplot(111)
        for t in range(1, HORIZON+1):
            x = plot_df['timestamp'][(t-1):]
            y = plot_df['t+'+str(t)][0:len(x)]
            ax.plot(x, y, color='blue', linewidth=4*math.pow(.9,t), alpha=math.pow(0.8,t))

        ax.legend(loc='best')

    plt.xlabel('timestamp', fontsize=12)
    plt.ylabel('load', fontsize=12)
    plt.show()
    ```

    ![роТро░рпБ роирпЗро░ ро╡ро░ро┐роЪрпИ рооро╛родро┐ро░ро┐](../../../../translated_images/accuracy.2c47fe1bf15f44b3656651c84d5e2ba9b37cd929cd2aa8ab6cc3073f50570f4e.ta.png)

ЁЯПЖ роТро░рпБ рооро┐роХ роЕро┤роХро╛рой ро╡ро░рпИрокроЯроорпН, роиро▓рпНро▓ родрпБро▓рпНро▓ро┐ропродрпНродрпБроЯройрпН роТро░рпБ рооро╛родро┐ро░ро┐ропрпИ роХро╛роЯрпНроЯрпБроХро┐ро▒родрпБ. роиро▓рпНро▓ ро╡рпЗро▓рпИ!

---

## ЁЯЪАроЪро╡ро╛ро▓рпН

роТро░рпБ роирпЗро░ ро╡ро░ро┐роЪрпИ рооро╛родро┐ро░ро┐ропро┐ройрпН родрпБро▓рпНро▓ро┐ропродрпНродрпИ роЪрпЛродро┐роХрпНроХ рокро▓ ро╡ро┤ро┐роХро│рпИ роЖро░ро╛ропрпБроЩрпНроХро│рпН. роЗроирпНрод рокро╛роЯродрпНродро┐ро▓рпН роиро╛роЩрпНроХро│рпН MAPE рокро▒рпНро▒ро┐ рокрпЗроЪрпБроХро┐ро▒рпЛроорпН, роЖройро╛ро▓рпН роирпАроЩрпНроХро│рпН рокропройрпНрокроЯрпБродрпНродроХрпНроХрпВроЯро┐роп рокро┐ро▒ роорпБро▒рпИроХро│рпН роЙро│рпНро│родро╛? роЕро╡ро▒рпНро▒рпИ роЖро░ро╛ропрпНроирпНродрпБ роХрпБро▒ро┐рокрпНрокро┐роЯрпНроЯрпБ роОро┤рпБродрпБроЩрпНроХро│рпН. [роЗроЩрпНроХрпЗ](https://otexts.com/fpp2/accuracy.html) роТро░рпБ рокропройрпБро│рпНро│ роЖро╡рогроорпН роХро┐роЯрпИроХрпНроХро┐ро▒родрпБ.

## [рокро╛роЯродрпНродро┐ро▒рпНроХрпБрокрпН рокро┐роирпНродрпИроп ро╡ро┐ройро╛роЯро┐ ро╡ро┐ройро╛](https://ff-quizzes.netlify.app/en/ml/)

## роородро┐рокрпНрокрпАроЯрпБ & роЪрпБропрокроЯро┐рокрпНрокрпБ

роЗроирпНрод рокро╛роЯроорпН ARIMA роЙроЯройрпН роирпЗро░ ро╡ро░ро┐роЪрпИ роХрогро┐рокрпНрокро┐ройрпН роЕроЯро┐рокрпНрокроЯрпИроХро│рпИ роороЯрпНроЯрпБроорпЗ родрпКроЯрпБроХро┐ро▒родрпБ. [роЗроирпНрод роХро│роЮрпНроЪро┐ропродрпНродрпИ](https://microsoft.github.io/forecasting/) рооро▒рпНро▒рпБроорпН роЕродройрпН рокро▓рпНро╡рпЗро▒рпБ рооро╛родро┐ро░ро┐ ро╡роХрпИроХро│рпИ роЖро░ро╛ропрпНроирпНродрпБ роирпЗро░ ро╡ро░ро┐роЪрпИ рооро╛родро┐ро░ро┐роХро│рпИ роЙро░рпБро╡ро╛роХрпНроХрпБроорпН рокро┐ро▒ ро╡ро┤ро┐роХро│рпИ роЕро▒ро┐роп роЙроЩрпНроХро│рпН роЕро▒ро┐ро╡рпИ роЖро┤рооро╛роХрпНроХ роирпЗро░роорпН роТродрпБроХрпНроХрпБроЩрпНроХро│рпН.

## рокрогро┐роХрпНроХроЯрпНроЯро│рпИ

[роТро░рпБ рокрпБродро┐роп ARIMA рооро╛родро┐ро░ро┐](assignment.md)

---

**роХрпБро▒ро┐рокрпНрокрпБ**:  
роЗроирпНрод роЖро╡рогроорпН [Co-op Translator](https://github.com/Azure/co-op-translator) роОройрпНро▒ AI роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБ роЪрпЗро╡рпИропрпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ роорпКро┤ро┐рокрпЖропро░рпНроХрпНроХрокрпНрокроЯрпНроЯрпБро│рпНро│родрпБ. роиро╛роЩрпНроХро│рпН родрпБро▓рпНро▓ро┐ропродрпНродро┐ро▒рпНроХро╛роХ роорпБропро▒рпНроЪро┐роХрпНроХро┐ро▒рпЛроорпН, роЖройро╛ро▓рпН родро╛ройро┐ропроЩрпНроХро┐ роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБроХро│ро┐ро▓рпН рокро┐ро┤рпИроХро│рпН роЕро▓рпНро▓родрпБ родро╡ро▒ро╛рой родроХро╡ро▓рпНроХро│рпН роЗро░рпБроХрпНроХроХрпНроХрпВроЯрпБроорпН роОройрпНрокродрпИ родропро╡рпБроЪрпЖропрпНродрпБ роХро╡ройродрпНродро┐ро▓рпН роХрпКро│рпНро│рпБроЩрпНроХро│рпН. роЕродройрпН родро╛ропрпНроорпКро┤ро┐ропро┐ро▓рпН роЙро│рпНро│ роорпВро▓ роЖро╡рогроорпН роЕродро┐роХро╛ро░рокрпНрокрпВро░рпНро╡ роЖродро╛ро░рооро╛роХ роХро░рпБродрокрпНрокроЯ ро╡рпЗрогрпНроЯрпБроорпН. роорпБроХрпНроХро┐ропрооро╛рой родроХро╡ро▓рпНроХро│рпБроХрпНроХрпБ, родрпКро┤ро┐ро▓рпНроорпБро▒рпИ рооройро┐род роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпБ рокро░ро┐роирпНродрпБро░рпИроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ. роЗроирпНрод роорпКро┤ро┐рокрпЖропро░рпНрокрпНрокрпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡родро╛ро▓рпН роПро▒рпНрокроЯрпБроорпН роОроирпНрод родро╡ро▒ро╛рой рокрпБро░ро┐родро▓рпНроХро│рпН роЕро▓рпНро▓родрпБ родро╡ро▒ро╛рой ро╡ро┐ро│роХрпНроХроЩрпНроХро│рпБроХрпНроХрпБ роиро╛роЩрпНроХро│рпН рокрпКро▒рпБрокрпНрокро▓рпНро▓.